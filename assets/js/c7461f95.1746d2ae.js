"use strict";(self.webpackChunkcompositor_live=self.webpackChunkcompositor_live||[]).push([[672],{9956:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var t=o(4848),r=o(8453);const i={},s="How to receive output streams",a={id:"guides/receive-output",title:"How to receive output streams",description:"Live Compositor currently supports 2 output types:",source:"@site/pages/guides/receive-output.md",sourceDirName:"guides",slug:"/guides/receive-output",permalink:"/docs/guides/receive-output",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"How to deliver input streams",permalink:"/docs/guides/deliver-input"},next:{title:"Basic Layouts",permalink:"/docs/guides/basic-layouts"}},d={},c=[{value:"RTP over TCP vs UDP",id:"rtp-over-tcp-vs-udp",level:3},{value:"What to use to receive RTP streams?",id:"what-to-use-to-receive-rtp-streams",level:3},{value:"Membrane Framework",id:"membrane-framework",level:4},{value:"FFmpeg",id:"ffmpeg",level:4},{value:"GStreamer",id:"gstreamer",level:4}];function p(e){const n={code:"code",h1:"h1",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"how-to-receive-output-streams",children:"How to receive output streams"}),"\n",(0,t.jsx)(n.p,{children:"Live Compositor currently supports 2 output types:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RTP (H264 + Opus)"}),"\n",(0,t.jsx)(n.li,{children:"MP4 (H264 + AAC)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"MP4 is useful for non real-time rendering scenarios, but for most streaming use cases RTP protocol will be a primary choice."}),"\n",(0,t.jsx)(n.p,{children:"To deliver RTP output stream in some other format you can use tools like FFmpeg, GStreamer or Membrane Framework to convert between RTP and the desired format."}),"\n",(0,t.jsx)(n.h3,{id:"rtp-over-tcp-vs-udp",children:"RTP over TCP vs UDP"}),"\n",(0,t.jsx)(n.p,{children:"RTP streams can be delivered over TCP or UDP. Depending on your use case, a different choice might make more sense, but in general, we recommend using TCP if possible."}),"\n",(0,t.jsx)(n.p,{children:"What to choose?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"If you are using the Membrane Framework plugin all communication already happens over TCP. Currently, we do not support any way to configure it."}),"\n",(0,t.jsx)(n.li,{children:"Some of the popular multimedia tools do not support RTP over TCP e.g. FFmpeg."}),"\n",(0,t.jsx)(n.li,{children:"UDP should only be used for communication on localhost. We do not support retransmission or packet reordering, so if you use it in an unreliable network it might lead to unexpected behavior."}),"\n",(0,t.jsx)(n.li,{children:"UDP does not have a congestion control, so if you are using any non-real-time sources for inputs (e.g. streaming file with FFmpeg over RTP) then if you don't throttle the input it might lead to high memory usage."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-to-use-to-receive-rtp-streams",children:"What to use to receive RTP streams?"}),"\n",(0,t.jsx)(n.h4,{id:"membrane-framework",children:"Membrane Framework"}),"\n",(0,t.jsxs)(n.p,{children:["If you are using the Membrane Framework plugin you do not need anything else. Just connect appropriate output pads to the ",(0,t.jsx)(n.code,{children:"LiveCompositor"})," bin."]}),"\n",(0,t.jsx)(n.h4,{id:"ffmpeg",children:"FFmpeg"}),"\n",(0,t.jsx)(n.p,{children:"FFmpeg does not support RTP over TCP, so you are limited to UDP only."}),"\n",(0,t.jsx)(n.p,{children:"Start by creating one of the following SDP files:"}),"\n",(0,t.jsxs)(n.p,{children:["For streaming H264 video to ",(0,t.jsx)(n.code,{children:"127.0.0.1:9001"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"output.sdp"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=No Name\nc=IN IP4 127.0.0.1\nm=video 9001 RTP/AVP 96\na=rtpmap:96 H264/90000\na=fmtp:96 packetization-mode=1\na=rtcp-mux\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For streaming H264 video to ",(0,t.jsx)(n.code,{children:"127.0.0.1:9001"})," and Opus audio to ",(0,t.jsx)(n.code,{children:"127.0.0.1:9002"})," (multiplexing on the same port does not seem to work)."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"output.sdp"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"v=0\no=- 0 0 IN IP4 127.0.0.1\ns=No Name\nc=IN IP4 127.0.0.1\nm=video 9001 RTP/AVP 96\na=rtpmap:96 H264/90000\na=fmtp:96 packetization-mode=1\na=rtcp-mux\nm=audio 9002 RTP/AVP 97\na=rtpmap:97 opus/48000/2\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To play the stream with ",(0,t.jsx)(n.code,{children:"ffplay"})," run:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffplay -protocol_whitelist "file,rtp,udp" output.sdp\n'})}),"\n",(0,t.jsx)(n.p,{children:"To save stream as mp4:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'ffmpeg -protocol_whitelist "file,rtp,udp" -i output.sdp out.mp4\n'})}),"\n",(0,t.jsx)(n.h4,{id:"gstreamer",children:"GStreamer"}),"\n",(0,t.jsxs)(n.p,{children:["Receive RTP stream on port ",(0,t.jsx)(n.code,{children:"127.0.0.1:9001"}),". Play both audio and video streams using ",(0,t.jsx)(n.code,{children:"autovideosink"}),"\nand ",(0,t.jsx)(n.code,{children:"autoaudiosink"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Connecting over TCP:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'gst-launch-1.0 rtpptdemux name=demux \\\n    tcpclientsrc host=127.0.0.1 port=9001 ! \\"application/x-rtp-stream\\" ! rtpstreamdepay ! queue ! demux. \\\n    demux.src_96 ! \\"application/x-rtp,media=video,clock-rate=90000,encoding-name=H264\\" ! queue \\\n    ! rtph264depay ! decodebin ! videoconvert ! autovideosink \\\n    demux.src_97 ! \\"application/x-rtp,media=audio,clock-rate=48000,encoding-name=OPUS\\" ! queue \\\n    ! rtpopusdepay ! decodebin ! audioconvert ! autoaudiosink\n'})}),"\n",(0,t.jsx)(n.p,{children:"Using UDP:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'gst-launch-1.0 rtpptdemux name=demux \\\n    udpsrc port=9001 ! \\"application/x-rtp\\" ! queue ! demux. \\\n    demux.src_96 ! \\"application/x-rtp,media=video,clock-rate=90000,encoding-name=H264\\" ! queue \\\n    ! rtph264depay ! decodebin ! videoconvert ! autovideosink \\\n    demux.src_97 ! \\"application/x-rtp,media=audio,clock-rate=48000,encoding-name=OPUS\\" ! queue \\\n    ! rtpopusdepay ! decodebin ! audioconvert ! autoaudiosink sync=false\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>a});var t=o(6540);const r={},i=t.createContext(r);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);